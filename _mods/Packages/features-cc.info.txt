contributor:
$Author: mlinton $

revision:
1.3.10

lastmodif:
$Date: 2005-04-13 12:20:42 $

files: 
features/cc/cc.php cc.php
features/cc/ccsp.php ccsp.php
features/cc/cc-admin.php cc-admin.php
features/cc/modules/mod-my_ledger.php modules/mod-my_ledger.php
features/cc/templates/modules/mod-my_ledger.tpl templates/modules/mod-my_ledger.tpl
features/cc/lib/cclib.php lib/cc/cclib.php
features/cc/templates/currencies.tpl templates/cc/currencies.tpl 
features/cc/templates/currencies_form.tpl templates/cc/currencies_form.tpl
features/cc/templates/currency_admin.tpl templates/cc/currency_admin.tpl
features/cc/templates/index.tpl templates/cc/index.tpl
features/cc/templates/admin.tpl templates/cc/admin.tpl
features/cc/templates/ledgers.tpl templates/cc/ledgers.tpl
features/cc/templates/transactions.tpl templates/cc/transactions.tpl
features/cc/templates/transactions_form.tpl templates/cc/transactions_form.tpl
features/cc/img/cancel_transaction.png img/cc/cancel_transaction.png
features/cc/img/currency.png img/cc/currency.png
features/cc/img/edit_c.png img/cc/edit_c.png
features/cc/img/pending_register_c.png img/cc/pending_register_c.png
features/cc/img/register_c.png img/cc/register_c.png
features/cc/img/transaction.png img/cc/transaction.png
features/cc/img/unregister_c.png img/cc/unregister_c.png

sql-install:
create table if not exists cc_cc ( seq int not null auto_increment, id varchar(255) not null, cc_name varchar(255) not null, cc_description text, owner_id varchar(255), cpun varchar(255) default '' not null,requires_approval char(1) not null, listed char(1) not null default 'n', primary key seq (seq), index ( id(16),cpun(16) ), index ( cc_name(6) ));
create table if not exists cc_ledger ( seq int not null primary key auto_increment, acct_id varchar(255) null, l_cpun varchar(255) default '' not null, cc_id varchar(255) not null, balance int not null, tr_total int not null, tr_count int not null, last_tr_date int(11), approved char(1), index ( acct_id ), index ( cc_id ), index ( last_tr_date));
create table if not exists cc_transaction ( seq int not null primary key auto_increment, tr_date int(11) not null, acct_id varchar(255) not null, cpun varchar(255) not null, other_id varchar(255), other_cpun varchar(255), cc_id varchar(255) not null, amount int not null, item varchar(255), type varchar(5), balance int not null, index (tr_date), index ( acct_id ));
create table if not exists cc_providers ( cpun varchar(255) not null default '', email varchar(255), url varchar(255), lastupdate int(8), status char(1) not null default 'c', primary key cpun (cpun));
create table if not exists cc_users ( userid int(11), login varchar(255), cpun varchar(255) not null default '', email varchar(255), primary key who (login(40),cpun));
INSERT IGNORE INTO tiki_preferences(name,value) VALUES ('feature_cc','n');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_use', 'Can use community currencies', 'registered', 'cc');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_create', 'Can create new community currencies', 'registered', 'cc');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_admin', 'Administrate the currencies system', 'admin', 'cc');
delete from tiki_menu_options where url like 'cc%';
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'s','Currencies','',1400,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Currencies Help','cc.php',1405,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Currencies Config','cc-admin.php',1407,'','tiki_p_cc_admin','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Create Currency','cc.php?page=currencies&new=1',1410,'','tiki_p_cc_create','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Add Transaction','cc.php?page=transactions&new=1',1420,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Currencies','cc.php?page=currencies&my=1',1430,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Ledgers','cc.php?page=ledgers&my=1',1440,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Transactions','cc.php?page=transactions&my=1',1450,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Currencies','cc.php?page=currencies&all=1',1460,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Ledgers','cc.php?page=ledgers&all=1',1470,'','tiki_p_cc_admin','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Transactions','cc.php?page=transactions&all=1',1480,'','tiki_p_cc_admin','');

sql-upgrade:
: 1.3.10
ALTER TABLE `cc_transaction` ADD `other_id` VARCHAR( 255 );
ALTER TABLE `cc_transaction` ADD `other_cpun` VARCHAR( 255 );
: 1.3.7
create table if not exists cc_providers ( cpun varchar(255) not null default '', email varchar(255), url varchar(255), lastupdate int(8), status char(1) not null default 'c', primary key cpun (cpun));
create table if not exists cc_users ( userid int(11), login varchar(255), cpun varchar(255) not null default '', email varchar(255), primary key who (login(40),cpun));
ALTER TABLE `cc_transaction` CHANGE `other_domain` `cpun` VARCHAR( 255 ) NOT NULL ;
ALTER TABLE `cc_cc` ADD `cpun` VARCHAR( 255 ) NOT NULL AFTER `owner_id` ;
ALTER TABLE `cc_cc` DROP `id_2` ;
ALTER TABLE `cc_cc` DROP `id` ;
ALTER TABLE `cc_cc` ADD INDEX ( `id` ( 16 ) , `cpun` ( 16 ) ) ;
ALTER TABLE `cc_ledger` ADD `l_cpun` VARCHAR( 255 ) DEFAULT '' NOT NULL AFTER `acct_id` ;
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Currencies Help','cc.php',1405,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Currencies Config','cc-admin.php',1407,'','tiki_p_cc_admin','');
update tiki_menu_options set url="cc.php?page=currencies&new=1" where name='Create Currency';
update tiki_menu_options set url="cc.php?page=transactions&new=1" where name='Add Transaction';
update tiki_menu_options set url="cc.php?page=currencies&my=1" where name='My Currencies';
update tiki_menu_options set url="cc.php?page=ledgers&my=1" where name='My Ledgers';
update tiki_menu_options set url="cc.php?page=transactions&my=1" where name='My Transactions';
update tiki_menu_options set url="cc.php?page=currencies&all=1" where name='List Currencies';
update tiki_menu_options set url="cc.php?page=ledgers&all=1" where name='List Ledgers';
update tiki_menu_options set url="cc.php?page=transactions&all=1" where name='List Transactions';
: 1.3.1
delete from tiki_menu_options where url like 'cc%';
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'s','Currencies','',1400,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Create Currency','cc.php?page=currencies&new',1410,'','tiki_p_cc_create','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Add Transaction','cc.php?page=transactions&new',1420,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Currencies','cc.php?page=currencies&my',1430,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Ledgers','cc.php?page=my_ledgers',1440,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Transactions','cc.php?page=transactions',1450,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Currencies','cc.php?page=currencies',1460,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Ledgers','cc.php?page=ledgers',1470,'','tiki_p_cc_admin','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Transactions','cc.php?page=transactions&all',1480,'','tiki_p_cc_admin','');

sql-remove:
drop table if exists cc_cc;
drop table if exists cc_ledger;
drop table if exists cc_transaction;

author:
Michael Linton
Thomas Riemer
Les Squires
Mose

licence:
GNU/LGPL

devurl:
http://dev.openmoney.org/TikiCc

Description: 
Multi-currencies management system

Changelog:
1.3.8 fixed other_cpun things
1.3.7 fixed sorting and the all=1 thing, and more usability development
1.3.6 transaction reversion by registry owner, ledger sorting, headings, layouts
1.3.5 layout changes, prevent self credit transaction
1.3.4 added possibility to register an unlisted currency
1.3.3 added help link and transaction from currencies list
1 initial package

